import os
from os.path import join, dirname
from dotenv import load_dotenv
import flask
import flask_sqlalchemy
import flask_socketio
import requests
import random
import chatbot
from google.oauth2 import id_token
from google.auth.transport import requests
import re

regex = re.compile(
        r'^(?:http|ftp)s?://' # http:// or https://
        r'(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\.)+(?:[A-Z]{2,6}\.?|[A-Z0-9-]{2,}\.?)|' #domain...
        r'localhost|' #localhost...
        r'\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})' # ...or ip
        r'(?::\d+)?' # optional port
        r'(?:/?|[/?]\S+)$', re.IGNORECASE)

regimg = re.compile(r".*\.(jpg|png|gif|jpeg).*$")

app = flask.Flask(__name__)
socketio = flask_socketio.SocketIO(app)
socketio.init_app(app, cors_allowed_origins="*")
userCount = 0

#SQL Work
MESSAGES_RECEIVED_CHANNEL = 'messages received'

database_uri = os.environ['DATABASE_URL']

app.config['SQLALCHEMY_DATABASE_URI'] = database_uri

db = flask_sqlalchemy.SQLAlchemy(app)
db.init_app(app)
db.app = app
import models 


def emit_all_messages(channel):
    all_messages = [ \
        db_message.messages for db_message \
        in db.session.query(models.MessageHistory).all()]
    
    all_users = [ \
        db_user.users for db_user \
        in db.session.query(models.MessageHistory).all()]
    
    all_images = [ \
        db_image.image for db_image \
        in db.session.query(models.MessageHistory).all()]
        
    
    socketio.emit(channel, {
        'allUsers': all_users,
        'allMessages': all_messages,
        'allImages' : all_images
    })
    
    


@app.route('/')
def hello():
    models.db.create_all()
    db.session.commit()
    emit_all_messages(MESSAGES_RECEIVED_CHANNEL)
    return flask.render_template('index.html')

@socketio.on('connect')
def on_connect():
    global userCount
    #print('Someone connected!')
    userCount+=1
    socketio.emit('newUser', {
        'count': userCount
    })
    emit_all_messages(MESSAGES_RECEIVED_CHANNEL)

@socketio.on('disconnect')
def on_disconnect():
    global userCount
    #print ('Someone disconnected!')
    userCount-=1
    socketio.emit('lessUser', {
        'count': userCount
    })

@socketio.on('message_user')
def handle_message(message_user):
    message = message_user["message"]
    user = message_user["user"]
    #print('User: ' + user)
    #print('Message: ' + message)
    
    db.session.add(models.MessageHistory(message,user, '', '', 'https://freerangestock.com/sample/120140/business-man-profile-vector.jpg'));
    db.session.commit();
    
    
    if re.match(regex, message) is not None:
        if re.match(regimg, message) is not None:
            returnMessage = chatbot.ChatBot(message).chatBotResponse()
            socketio.emit('message&user', {
            'user': 'Yoda_Bot',
            'message': returnMessage,
            'image' : 'data:image/jpeg;base64,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'
            })
        else:
            returnMessage = "<a href=" + message +">" + message + "</a>"
            socketio.emit('message&user', {
            'user': user,
            'message': returnMessage,
            'image' : 'https://freerangestock.com/sample/120140/business-man-profile-vector.jpg'
            })
    
    else:
        socketio.emit('message&user', {
            'user': user,
            'message': message,
            'image' : 'https://freerangestock.com/sample/120140/business-man-profile-vector.jpg'
        })
    
    
    if message[0] and message[1] == '!':
        returnMessage = chatbot.ChatBot(message).chatBotResponse()
        socketio.emit('message&user', {
        'user': 'Yoda_Bot',
        'message': returnMessage,
        'image' : 'data:image/jpeg;base64,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'
            
        })

@socketio.on('google_login')
def id_received(google_login):
    try:
    # Specify the CLIENT_ID of the app that accesses the backend:
        idinfo = id_token.verify_oauth2_token(google_login['tokenid'], requests.Request(), "161766459403-fh1ligbs7qp49qq9tl16ndrtl9ia712a.apps.googleusercontent.com")
        userid = idinfo['sub']
        
        db.session.add(models.MessageHistory(google_login["message"], google_login['user'], google_login['tokenid'], google_login['email'], google_login["image"]));
        db.session.commit(); 
        
        message = google_login['message']
        user = google_login['user']
        image = google_login["image"]
       
        if re.match(regex, message) is not None:
            if re.match(regimg, message) is not None:
                returnMessage = chatbot.ChatBot(message).chatBotResponse()
                socketio.emit('message&user', {
                'user': 'Yoda_Bot',
                'message': returnMessage,
                'image' : 'data:image/jpeg;base64,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'
                })
            else:
                returnMessage = "<a href=" + message +">" + message + "</a>"
                socketio.emit('message&user', {
                'user': user,
                'message': returnMessage,
                'image' : image
                })
    
        else:
            socketio.emit('message&user', {
                'user': user,
                'message': message,
                'image' : image
            })
        
       
        if message[0] and message[1] == '!':
            returnMessage = chatbot.ChatBot(message).chatBotResponse()
            socketio.emit('message&user', {
            'user': 'Yoda_Bot',
            'message': returnMessage,
            'image' : 'data:image/jpeg;base64,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'
                
            })
            
    except ValueError:
        # Invalid token
        socketio.emit('invalid', 'You have passed invalid credentials')
        
        
@socketio.on('messages requested')
def allMessages():
    emit_all_messages(MESSAGES_RECEIVED_CHANNEL)

@socketio.on('usercount requested')
def giveUserCount():
    global userCount
    socketio.emit('userNum', {
        'count': userCount
    })

if __name__ == '__main__': 
    socketio.run(
        app,
        host=os.getenv('IP', '0.0.0.0'),
        port=int(os.getenv('PORT', 8080)),
        debug=True
    )